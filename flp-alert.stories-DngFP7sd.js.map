{"version":3,"file":"flp-alert.stories-DngFP7sd.js","sources":["../src/components/flp-alert/flp-alert.styles.ts","../src/components/flp-alert/flp-alert.ts"],"sourcesContent":["import { css } from 'lit';\nimport componentStyles from '../../styles/component.styles';\n\nexport const flippico = css`\n${componentStyles}\n\n:host {\n  display: contents;\n\n  /* For better DX, we'll reset the margin here so the base part can inherit it */\n  margin: 0;\n}\n\n.alert {\n  position: relative;\n  display: flex;\n  align-items: stretch;\n  background-color: var(--flp-panel-background-color);\n  border: solid var(--flp-panel-border-width) var(--flp-panel-border-color);\n  border-top-width: calc(var(--flp-panel-border-width) * 3);\n  border-radius: var(--flp-border-radius-medium);\n  font-family: var(--flp-font-light);\n  font-size: var(--flp-font-size-small);\n  font-weight: var(--flp-font-weight-normal);\n  line-height: 1.6;\n  color: var(--flp-color-neutral-700);\n  margin: inherit;\n}\n\n.alert:not(.alert--has-icon) .alert__icon,\n.alert:not(.alert--closable) .alert__close-button {\n  display: none;\n}\n\n.alert__icon {\n  flex: 0 0 auto;\n  display: flex;\n  align-items: center;\n  font-size: var(--flp-font-size-large);\n  padding-inline-start: var(--flp-spacing-large);\n}\n\n.alert--primary {\n  border-top-color: var(--flp-color-primary-600);\n}\n\n.alert--primary .alert__icon {\n  color: var(--flp-color-primary-600);\n}\n\n.alert--success {\n  border-top-color: var(--flp-color-success-600);\n}\n\n.alert--success .alert__icon {\n  color: var(--flp-color-success-600);\n}\n\n.alert--neutral {\n  border-top-color: var(--flp-color-neutral-600);\n}\n\n.alert--neutral .alert__icon {\n  color: var(--flp-color-neutral-600);\n}\n\n.alert--warning {\n  border-top-color: var(--flp-color-warning-600);\n}\n\n.alert--warning .alert__icon {\n  color: var(--flp-color-warning-600);\n}\n\n.alert--danger {\n  border-top-color: var(--flp-color-danger-600);\n}\n\n.alert--danger .alert__icon {\n  color: var(--flp-color-danger-600);\n}\n\n.alert__message {\n  flex: 1 1 auto;\n  display: block;\n  padding: var(--flp-spacing-large);\n  overflow: hidden;\n}\n\n.alert__close-button {\n  flex: 0 0 auto;\n  display: flex;\n  align-items: center;\n  font-size: var(--flp-font-size-medium);\n  padding-inline-end: var(--flp-spacing-medium);\n}\n`;","import { CSSResultGroup, html } from 'lit';\nimport FlpElement from '../../utils/flippico-element';\nimport {customElement, property, query} from 'lit/decorators.js';\n\nimport { flippico } from './flp-alert.styles';\nimport { HasSlotController } from '../../utils/slot';\nimport { watch } from '../../utils/watch';\nimport { animateTo, stopAnimations } from '../../utils/animate';\nimport { getAnimation, setDefaultAnimation } from '../../utils/animation-registry';\nimport { waitForEvent } from '../../utils/event';\nimport { classMap } from 'lit/directives/class-map.js';\n\nconst toastStack = Object.assign(document.createElement('div'), { className: 'flp-toast-stack' });\n\n/**\n * @summary This the flp-alert component\n *\n * @tag flp-alert\n */\n @customElement(\"flp-alert\")\nexport class FlpAlert extends FlpElement {\n  static styles: CSSResultGroup = [flippico];\n  private autoHideTimeout: number;\n  private readonly hasSlotController = new HasSlotController(this, 'icon', 'suffix');\n\n  @query('[part~=\"base\"]') base: HTMLElement;\n\n  /**\n   * Indicates whether or not the alert is open. You can toggle this attribute to show and hide the alert, or you can\n   * use the `show()` and `hide()` methods and this attribute will reflect the alert's open state.\n   */\n  @property({ type: Boolean, reflect: true }) open = false;\n\n  /** Enables a close button that allows the user to dismiss the alert. */\n  @property({ type: Boolean, reflect: true }) closable = false;\n\n  /** The alert's theme variant. */\n  @property({ reflect: true }) variant: 'primary' | 'success' | 'neutral' | 'warning' | 'danger' = 'primary';\n\n  /**\n   * The length of time, in milliseconds, the alert will show before closing itself. If the user interacts with\n   * the alert before it closes (e.g. moves the mouse over it), the timer will restart. Defaults to `Infinity`, meaning\n   * the alert will not close on its own.\n   */\n  @property({ type: Number }) duration = Infinity;\n\n  firstUpdated() {\n    this.base.hidden = !this.open;\n  }\n\n  private restartAutoHide() {\n    clearTimeout(this.autoHideTimeout);\n    if (this.open && this.duration < Infinity) {\n      this.autoHideTimeout = window.setTimeout(() => this.hide(), this.duration);\n    }\n  }\n\n  private handleCloseClick() {\n    this.hide();\n  }\n\n  private handleMouseMove() {\n    this.restartAutoHide();\n  }\n\n  @watch('open', { waitUntilFirstUpdate: true })\n  async handleOpenChange() {\n    if (this.open) {\n      // Show\n      this.emit('flp-show');\n\n      if (this.duration < Infinity) {\n        this.restartAutoHide();\n      }\n\n      await stopAnimations(this.base);\n      this.base.hidden = false;\n      const { keyframes, options } = getAnimation(this, 'alert.show', { dir: 'ltr' });\n      await animateTo(this.base, keyframes, options);\n\n      this.emit('flp-after-show');\n    } else {\n      // Hide\n      this.emit('flp-hide');\n\n      clearTimeout(this.autoHideTimeout);\n\n      await stopAnimations(this.base);\n      const { keyframes, options } = getAnimation(this, 'alert.hide', { dir: 'ltr' });\n      await animateTo(this.base, keyframes, options);\n      this.base.hidden = true;\n\n      this.emit('flp-after-hide');\n    }\n  }\n\n  @watch('duration')\n  handleDurationChange() {\n    this.restartAutoHide();\n  }\n\n  /** Shows the alert. */\n  async show() {\n    if (this.open) {\n      return undefined;\n    }\n\n    this.open = true;\n    return waitForEvent(this, 'flp-after-show');\n  }\n\n  /** Hides the alert */\n  async hide() {\n    if (!this.open) {\n      return undefined;\n    }\n\n    this.open = false;\n    return waitForEvent(this, 'flp-after-hide');\n  }\n\n  /**\n   * Displays the alert as a toast notification. This will move the alert out of its position in the DOM and, when\n   * dismissed, it will be removed from the DOM completely. By storing a reference to the alert, you can reuse it by\n   * calling this method again. The returned promise will resolve after the alert is hidden.\n   */\n  async toast() {\n    return new Promise<void>(resolve => {\n      if (toastStack.parentElement === null) {\n        document.body.append(toastStack);\n      }\n\n      toastStack.appendChild(this);\n\n      // Wait for the toast stack to render\n      requestAnimationFrame(() => {\n        // eslint-disable-next-line @typescript-eslint/no-unused-expressions -- force a reflow for the initial transition\n        this.clientWidth;\n        this.show();\n      });\n\n      this.addEventListener(\n        'flp-after-hide',\n        () => {\n          toastStack.removeChild(this);\n          resolve();\n\n          // Remove the toast stack from the DOM when there are no more alerts\n          if (toastStack.querySelector('flp-alert') === null) {\n            toastStack.remove();\n          }\n        },\n        { once: true }\n      );\n    });\n  }\n\n  render() {\n    return html`\n      <div\n        part=\"base\"\n        class=${classMap({\n          alert: true,\n          'alert--open': this.open,\n          'alert--closable': this.closable,\n          'alert--has-icon': this.hasSlotController.test('icon'),\n          'alert--primary': this.variant === 'primary',\n          'alert--success': this.variant === 'success',\n          'alert--neutral': this.variant === 'neutral',\n          'alert--warning': this.variant === 'warning',\n          'alert--danger': this.variant === 'danger'\n        })}\n        role=\"alert\"\n        aria-hidden=${this.open ? 'false' : 'true'}\n        @mousemove=${this.handleMouseMove}\n      >\n        <div part=\"icon\" class=\"alert__icon\">\n          <slot name=\"icon\"></slot>\n        </div>\n\n        <div part=\"message\" class=\"alert__message\" aria-live=\"polite\">\n          <slot></slot>\n        </div>\n\n        ${this.closable\n          ? html`\n              <flp-icon-button\n                part=\"close-button\"\n                exportparts=\"base:close-button__base\"\n                class=\"alert__close-button\"\n                name=\"x-lg\"\n                library=\"system\"\n                label=\"close\"\n                @click=${this.handleCloseClick}\n              ></flp-icon-button>\n            `\n          : ''}\n      </div>\n    `;\n  }\n}\n\nsetDefaultAnimation('alert.show', {\n  keyframes: [\n    { opacity: 0, scale: 0.8 },\n    { opacity: 1, scale: 1 }\n  ],\n  options: { duration: 250, easing: 'ease' }\n});\n\nsetDefaultAnimation('alert.hide', {\n  keyframes: [\n    { opacity: 1, scale: 1 },\n    { opacity: 0, scale: 0.8 }\n  ],\n  options: { duration: 250, easing: 'ease' }\n});\n"],"names":["flippico","css","componentStyles","toastStack","FlpAlert","FlpElement","HasSlotController","stopAnimations","keyframes","options","getAnimation","animateTo","waitForEvent","resolve","html","classMap","__decorateClass","query","property","watch","customElement","setDefaultAnimation"],"mappings":"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"}